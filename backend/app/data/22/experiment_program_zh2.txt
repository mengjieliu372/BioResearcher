{
    "Part 1": "第1部分：样本收集和准备\n\nI. 从Recount3和其他公共数据库下载数据：\n1. 从Recount3 R包（版本1.0）下载肿瘤和正常组织样本的原始基因计数。\n2. 确保来自多个来源的原始读取，包括由TCGA和基因型-组织表达项目（GTEx）生成的癌症和非疾病组织，通过使用STAR（版本2.7.3a）和Megadepth（版本1.0.1）的管道统一处理，以对UCSC hg38组装体进行对齐和定量。\n3. 使用Recount3文档中提供的特定命令或代码片段访问和下载原始基因计数。例如：\n```R\nlibrary(recount3)\nproject_info <- available_projects()\n# 下载TCGA SARC项目的数据\ndata_sarc <- create_rse(project = 'TCGA-SARC')\n# 下载GTEx项目的数据\ndata_gtex <- create_rse(project = 'GTEx')\n```\n4. 对于GEO数据集，下载相关数据集，如GSE213300、GSE201056、GSE179720、GSE221493和GSE221492。例如，要下载GSE213300：\n- 导航到GEO网站并搜索GSE213300\n- 从提供的链接下载原始和处理过的数据文件\n5. 通过使用校验和或其他验证方法检查下载文件的完整性来处理数据下载过程中的潜在错误。\n\n参考来源：{'ijms-24-14732': {'Part 1': ['step 1']}}\n\nII. 脂肪肉瘤和正常组织样本的选择标准：\nA. 选择高度分化和去分化脂肪肉瘤样本的标准：\n1. 肿瘤样本来自属于TCGA联盟的SARC项目。\n2. 正常样本从GTEx联盟的多个组织项目中下载，并进一步根据特定组织部位详细信息（例如，脂肪组织、子宫、食管、胃、血管、肌肉和皮肤成纤维细胞）进行选择。\n3. 根据读取对齐统计（例如，对齐读取的百分比> 70%）和数据分布的目视检查，从肉瘤项目中过滤掉低质量和非原发性肿瘤样本。使用FastQC等工具进行目视检查。\n4. 根据参考研究的补充信息中详细说明的先前专家病理学审查，修改亚型分类。如果没有专家病理学审查，则使用基于基因表达谱的自动分类算法等替代方法。\n5. 优先选择高度分化（WDLPS）和去分化（DDLPS）脂肪肉瘤样本进行详细分析。记录样本优先级的标准和理由。\n\n参考来源：{'ijms-24-14732': {'Part 1': ['step 2']}}\n\nIII. 新鲜肿瘤样本、冷冻样本和石蜡切片的收集：\n1. 收集正在进行原发性未治疗去分化脂肪肉瘤（DDLPS）手术的患者的新鲜肿瘤样本（N=11）。\n2. 对每个肿瘤，在病理学家的宏观检查中识别和分离配对的良好分化（WD）和去分化（DD）成分。\n3. 收集额外的脂肪细胞肿瘤（WDLPS，N=5；脂肪瘤，N=1）和正常脂肪组织（N=5）以作比较。\n4. 手术后立即处理样本以确保细胞活力。使用标准组织保存协议，例如液氮快速冷冻或福尔马林固定用于石蜡包埋。对于快速冷冻，采集后立即将组织浸入液氮中并储存在-80°C。对于福尔马林固定，将组织浸入10%中性缓冲福尔马林中24小时，然后转移到70%乙醇中再进行石蜡包埋。\n5. 在进一步处理之前，在适当的条件下储存冷冻样本和石蜡切片。详细记录样本的收集、处理和储存条件，包括日期、时间和任何偏离标准协议的情况。\n\n参考来源：{'41467_2024_Article_52067': {'Part 1': ['step 1']}}",
    "Part 2": "第2部分：RNA测序和质量控制\n\nI. 从收集的样本中提取RNA  \n1. 收集冷冻肿瘤样本、肉瘤细胞系和石蜡切片。  \n2. 对于冷冻样本和细胞系，使用RNeasy试剂盒（Qiagen）按照制造商的协议进行总RNA提取。  \n   a. 在含有β-巯基乙醇（10 µL/mL）的RLT缓冲液中匀浆样本。  \n   b. 向裂解液中加入70%乙醇，并应用于RNeasy旋转柱。  \n   c. 用RW1缓冲液和RPE缓冲液洗涤。  \n   d. 在无RNase水中洗脱RNA。  \n3. 对于石蜡包埋切片，使用RNeasy FFPE试剂盒（Qiagen）提取总RNA。  \n   a. 使用二甲苯和乙醇洗涤去除石蜡。  \n   b. 在56°C下用蛋白酶K消化15分钟，然后在80°C下消化15分钟。  \n   c. 按照试剂盒协议继续进行RNA提取。  \n4. 对所有RNA样本进行柱上DNase I处理（10 U/µL，在室温下孵育15分钟）以消除基因组DNA污染。  \n5. 使用NanoDrop分光光度计定量RNA，并使用Agilent 2100生物分析仪评估RNA完整性。确保RNA完整性数值（RIN）大于7，以获得高质量RNA。  \n6. 使用以下试剂体积：每1-2百万细胞使用350 µL RLT缓冲液，70%乙醇与裂解液按1:1比例，700 µL RW1缓冲液，500 µL RPE缓冲液。  \n\n参考来源：{'1-s2.0-S104366182200408X-main': {'第1部分': ['步骤1']}, 'nihms-2028845': {'第1部分': ['步骤1']}}  \n\nII. 收集样本的RNA测序  \nA. 使用Illumina测序平台  \n1. 使用Illumina NovaSeq 6000平台进行RNA测序。  \n2. 使用TruSeq Stranded mRNA Library Prep Kit（Illumina）按照制造商的说明制备RNA-seq文库。  \n   a. 进行poly-A选择以富集mRNA。  \n   b. 使用片段化缓冲液将cDNA片段化至平均大小为200-300 bp。  \n   c. 合成第一和第二链cDNA。  \n   d. 将Illumina接头连接到cDNA片段，并通过PCR扩增，使用以下条件：98°C 30秒，15个循环98°C 10秒，60°C 30秒，72°C 30秒，最后在72°C延伸5分钟。  \n3. 使用Agilent 2100生物分析仪和qPCR验证文库大小和浓度。  \n4. 在Illumina NovaSeq 6000平台上测序文库，生成150个碱基的双端读数。  \nB. RNA测序的具体步骤  \n1. 确保每个样本的测序覆盖度至少为5000万读数，对于单细胞RNA-seq，每个细胞至少为100,000读数。  \n2. 包括以下步骤进行文库验证：  \n   a. 使用Agilent生物分析仪DNA高灵敏度芯片检查文库的大小分布。  \n   b. 使用文库定量试剂盒（如KAPA Library Quantification Kit）通过qPCR定量文库。  \n\n参考来源：{'1-s2.0-S104366182200408X-main': {'第1部分': ['步骤2']}, 'nihms-2028845': {'第1部分': ['步骤1']}}  \n\nIII. 使用FastQC进行质量控制  \n1. 使用FastQC（https://www.bioinformatics.babraham.ac.uk/projects/fastqc/）对原始RNA测序数据进行质量控制检查。  \n2. 评估每个碱基的序列质量、GC含量和序列重复水平等指标。  \n3. 为每个样本生成FastQC报告并进行审查以确保数据质量高。  \n4. 可接受的质量阈值：每个碱基的序列质量>20，GC含量在40-60%之间，序列重复水平<10%。  \n5. 解释FastQC报告：  \n   a. 每个碱基的序列质量：确保大多数碱基的质量评分>20。  \n   b. GC含量：检查是否在40-60%范围内呈正态分布。  \n   c. 序列重复水平：低重复水平（<10%）表示文库复杂性良好。  \n\n参考来源：{'nihms-2028845': {'第1部分': ['步骤2']}}  \n\nIV. 使用Trimmomatic去除低质量读数  \n1. 使用Trimmomatic（http://www.usadellab.org/cms/?page=trimmomatic）去除低质量读数和接头序列。  \n2. 应用以下参数：LEADING:3, TRAILING:3, SLIDINGWINDOW:4:15, MINLEN:36。  \n3. 确保仅保留高质量读数以供进一步分析。  \n4. 如果质量问题仍然存在，考虑将SLIDINGWINDOW参数调整为SLIDINGWINDOW:4:20或将MINLEN参数增加到MINLEN:50。  \n\n参考来源：{'nihms-2028845': {'第1部分': ['步骤2']}}  \n\nV. 使用RSEM的归一化技术（TPM, RPKM, FPKM）  \n1. 使用RSEM（https://github.com/deweylab/RSEM）归一化表达水平。  \n   a. 使用Bowtie2将读数比对到参考基因组，使用以下命令：'rsem-calculate-expression --bowtie2 --paired-end sample_1.fastq sample_2.fastq reference_name output_name'。  \n   b. 估计基因和异构体的表达水平。  \n2. 计算每个基因的每百万转录本（TPM），以考虑测序深度和基因长度。  \n3. 另外，计算每千碱基转录本每百万映射读数（RPKM）和每千碱基转录本每百万映射片段（FPKM）以进行比较。  \n4. 使用log2转换（log2(TPM+1)）和z-score归一化进行下游分析。  \n\n参考来源：{'nihms-2028845': {'第1部分': ['步骤2']}}  ",
    "Part 3": "第3部分：数据预处理和标准化\n\n一、原始RNA-seq数据的质量控制检查：\n1. 从以下数据集中收集原始RNA-seq数据：GSE213300、GSE201056、GSE179720、GSE221493和GSE221492。\n2. 使用FastQC（https://www.bioinformatics.babraham.ac.uk/projects/fastqc/）对原始RNA-seq数据进行质量控制检查。确保每个样本通过质量指标，如每碱基序列质量（平均质量得分>20）、每序列GC含量（在40-60%之间）和序列重复水平（少于20%）。\n3. 为每个数据集生成一份总结报告，以记录质量控制指标并识别任何未通过检查的样本。对于未通过的样本，考虑重新测序或将其排除在进一步分析之外。\n\n参考来源：{'nihms-2028845': {'Part 1': ['step 2']}, 'ijms-24-14732': {'Part 1': ['step 3']}}\n\n二、读取修剪和过滤：\n1. 使用Trimmomatic（http://www.usadellab.org/cms/?page=trimmomatic）从原始RNA-seq数据中去除低质量的读取和接头序列。\n2. 为Trimmomatic设置以下参数：\n   - LEADING: 3\n   - TRAILING: 3\n   - SLIDINGWINDOW: 4:15\n   - MINLEN: 36\n3. 确保修剪后的读取具有高质量得分且无接头污染。记录每个数据集在修剪前后的读取数量。选择的参数确保修剪掉末端低质量碱基，并保留足够长度的读取进行分析。\n\n参考来源：{'nihms-2028845': {'Part 1': ['step 2']}}\n\n三、使用TMM和其他方法对基因计数进行标准化：\nA. TMM和其他标准化方法的解释：\n   1. 使用edgeR包（版本3.32.1）中实现的Trimmed Mean of M-values（TMM）方法进行标准化。TMM通过计算缩放因子来考虑文库大小和组成的差异。\n   2. 另外，使用limma包（版本3.46.0）中的voom函数将标准化计数转换为log2每百万计数（CPM），并估计均值-方差关系。\nB. 确保样本和条件之间的数据可比性：\n   1. 标准化以下数据集的原始基因计数：GSE213300、GSE201056、GSE179720、GSE221493和GSE221492。\n   2. 应用TMM方法以考虑文库大小和组成的差异。\n   3. 使用voom函数将标准化计数转换为log2 CPM，并估计均值-方差关系。\n   4. 通过解释TMM和voom如何解决潜在偏差并确保准确的下游分析来证明选择标准化方法的合理性。记录标准化步骤和使用的参数。为了比较，考虑替代标准化方法如DESeq2，并根据数据特征证明最终选择的合理性。\n\n参考来源：{'ijms-24-14732': {'Part 1': ['step 3', 'step 4']}}\n\n四、来自多个来源的数据整合，包括公共数据库和内部样本：\n1. 整合以下数据集的RNA-seq数据：GSE213300、GSE201056、GSE179720、GSE221493和GSE221492，以及来自80个病例的内部样本和来自10个病例的单细胞测序数据。\n2. 使用Celligner工具（https://figshare.com/articles/dataset/Celligner_data/11965269）对来自多个来源的RNA-seq数据进行对齐和整合。\n3. 对整合后的数据进行UMAP聚类，以根据癌症类型和代谢特征识别聚类。使用以下UMAP参数：n_neighbors = 50, min_dist = 0.5, metric = 'pearson'。\n4. 确保整合过程保持数据的可比性并解决批处理效应。记录整合步骤和使用的任何参数。考虑用于数据整合的替代工具或方法，如用于批处理效应校正的ComBat，并根据数据特征证明最终选择的合理性。\n\n参考来源：{'nihms-2028845': {'Part 1': ['step 5']}}",
    "Part 4": "第4部分：差异表达分析\n\n使用limma包识别高度分化（WDLPS）和去分化（DDLPS）脂肪肉瘤之间的差异表达基因（DEGs）包括以下步骤：\n1. 数据准备：从RNA-seq数据集GSE213300、GSE201056、GSE179720、GSE221493和GSE221492导入标准化表达数据，确保样本正确标记为WDLPS或DDLPS。\n2. 设计矩阵：创建一个设计矩阵来指定实验设置，指明哪些样本属于WDLPS，哪些属于DDLPS。\n3. 模型拟合：使用设计矩阵对表达数据拟合线性模型。使用lmFit函数的默认参数。\n4. 对比矩阵：使用makeContrasts函数定义对比，以比较WDLPS与DDLPS。\n5. DEG识别：使用eBayes函数对拟合模型应用经验贝叶斯调节，并使用topTable函数根据调整后的p值阈值<0.05提取DEGs。\n6. 结果汇编：汇编包含log折叠变化和调整后的p值等统计信息的DEGs列表。\n\n参考来源：{'cancers-15-03360': {'第1部分': ['步骤2', '步骤3', '步骤4']}, '41467_2024_Article_52067': {'第3部分': ['步骤4']}}\n\n差异激活回路的功能注释包括对识别的DEGs进行基因本体（GO）富集分析。\n1. 基因列表准备：提取第1步中识别的显著DEGs列表。\n2. GO富集分析：使用Toppfun进行GO富集分析。\n   - 访问Toppfun网站（https://toppgene.cchmc.org/enrichment.jsp）。\n   - 上传DEGs列表。\n   - 选择“基因本体”，并选择生物过程、分子功能和细胞成分。\n   - 将富集的显著性水平设置为调整后的p值<0.05。\n3. 通路识别：识别在WDLPS和DDLPS中差异激活的关键通路和回路，强调代谢通路。\n\n参考来源：cancers-15-03360：第1部分，步骤6\n\n差异表达结果的可视化包括创建可视化表示，以帮助解释和传达发现。\n1. 火山图：生成火山图以显示DEGs，突出显示具有显著p值和折叠变化的基因。使用GraphPad Prism或R包ggplot2等工具。\n2. 热图：创建顶级DEGs的热图，以可视化样本间的表达模式。使用R包pheatmap或ComplexHeatmap等工具。\n3. 通路图：使用Cytoscape或PathVisio等软件工具生成图表，说明第2步中识别的富集代谢通路。\n\n参考来源：cancers-15-03360：第1部分，步骤5\n\n讨论发现的生物学意义包括在生物学背景下解释结果。\n1. 代谢通路的注释：讨论差异表达的代谢通路在脂肪肉瘤分化背景下的相关性。使用KEGG和Reactome等资源获取通路信息。\n2. 生物学意义：探索发现的潜在生物学意义，例如识别的通路在肿瘤进展或治疗抵抗中的作用。\n3. 未来方向：建议未来的实验或分析，以进一步阐明这些通路在脂肪肉瘤中的作用。考虑使用额外的数据集或单细胞测序数据以获取更详细的见解。\n\n参考来源：41467_2024_Article_52067：第3部分，步骤5",
    "Part 5": "第5部分：通路富集和功能注释\n\nI. 不同癌症类型的通路活性评分计算：\n1. 收集来自数据集GSE213300、GSE201056、GSE179720、GSE221493和GSE221492的RNA-seq数据，包括脂肪肉瘤样本的整体和单细胞RNA-seq数据。\n2. 使用edgeR包中的TMM方法对基因表达数据进行标准化，以确保样本间的可比性。\n3. 使用GSVA包（版本1.38.2）为每个样本计算通路活性评分。使用来自MSigDB数据库（版本7.4）的KEGG通路基因集来定义通路。设置GSVA函数的参数，如method='ssgsea'和mx.diff=TRUE，以计算富集分数。\n4. 汇总不同癌症类型的通路活性评分，重点关注高度分化（WDLPS）和去分化（DDLPS）的脂肪肉瘤样本。使用ANOVA等统计方法比较组间的通路活性评分。指定ANOVA设置，包括使用Tukey's HSD等事后测试进行多重比较。\n5. 通过与文献中已知的通路活性模式进行比较，使用相关分析或其他统计验证方法验证通路活性评分。包括具体的验证参考或标准。\n\n参考来源：{'ijms-24-14732': {'第5部分': ['步骤1']}}\n\nII. 使用KEGG通路进行通路富集分析：\n1. 使用第4部分中从数据集GSE213300、GSE201056、GSE179720、GSE221493和GSE221492中识别的DEGs。\n2. 使用clusterProfiler包（版本3.18.1）进行通路富集分析，以识别在DEGs中显著富集的KEGG通路。\n3. 使用Benjamini-Hochberg方法进行多重检验校正，将通路富集的显著性阈值设定为调整后的p值<0.05。\n4. 重点关注与代谢、细胞周期和信号转导相关的通路。\n5. 通过与KEGG数据库和相关文献中的已知通路进行交叉引用来验证富集的通路。包括与脂肪肉瘤分化中涉及的已知代谢通路的详细比较。\n\n参考来源：ijms-24-14732，第5部分\n\nIII. 对DEGs进行功能注释以识别关键代谢通路：\n1. 使用org.Hs.eg.db包（版本3.12.0）注释DEGs，将基因符号映射到Entrez ID。\n2. 使用enrichR包（版本3.0）进行基因本体（GO）富集分析，重点关注与代谢相关的生物过程。\n3. 识别在DEGs中过度表达的关键代谢通路，特别是那些涉及脂质代谢、糖异生和能量生产的通路。\n4. 通过与文献和相关数据库中的已知代谢过程和通路进行比较来验证功能注释结果。包括关于这些通路在脂肪肉瘤分化中的作用和潜在治疗靶点的具体假设。\n\n参考来源：ijms-24-14732，第5部分",
    "Part 6": "第六部分：单细胞和整体RNA-seq数据的整合\n\nI. 单细胞RNA-seq数据的整合和聚类：\n\n**概述：** 此步骤涉及预处理、整合和聚类单细胞RNA-seq数据，以分析肿瘤异质性。\n\n1. **数据预处理：**\n   - 从GSE221493数据集中加载单细胞RNA-seq数据。\n   - 使用Seurat（版本4.1.0）的SCTransform函数对数据进行标准化，以调整测序深度和其他技术变异。\n   - 示例命令：`seurat_object <- SCTransform(seurat_object)`。\n   - **注意：** SCTransform有助于减少技术噪音并提高生物信号的检测。\n\n2. **降维：**\n   - 对3000个最具变异性的基因进行主成分分析（PCA）以减少维度。\n   - 示例命令：`seurat_object <- RunPCA(seurat_object, features = VariableFeatures(object = seurat_object))`。\n   - **原理：** PCA有助于识别出数据中捕捉方差的最重要特征。\n\n3. **批次效应校正：**\n   - 使用Harmony包（版本0.1.0）整合来自多个样本的数据集，校正批次效应。\n   - 参数：theta=2, lambda=1, nclust=50。\n   - 示例命令：`seurat_object <- RunHarmony(seurat_object, group.by.vars = 'batch', theta = 2, lambda = 1, nclust = 50)`。\n   - **注意：** Harmony将数据集对齐到共享空间，促进跨批次的整合。\n\n4. **可视化：**\n   - 计算前50个PCA组件的UMAP维度用于可视化。\n   - 示例命令：`seurat_object <- RunUMAP(seurat_object, dims = 1:50)`。\n   - **目的：** UMAP提供了数据聚类的二维可视化表示。\n\n5. **聚类：**\n   - 使用Seurat的FindNeighbors和FindClusters函数对整合数据进行聚类。\n   - 参数：resolution=0.8, k.param=20。\n   - 示例命令：`seurat_object <- FindNeighbors(seurat_object, dims = 1:50, k.param = 20)` 和 `seurat_object <- FindClusters(seurat_object, resolution = 0.8)`。\n   - **验证：** 将聚类结果与已知标记基因进行比较以验证结果。\n   - 示例命令：`FeaturePlot(seurat_object, features = c('marker1', 'marker2'))`。\n\n6. **故障排除：**\n   - 如果整合问题出现，考虑调整Harmony参数或使用Seurat中的CCA等替代方法。\n   - **替代工具：** 如果Seurat不可用，考虑使用Scanpy进行Python分析。\n\n参考来源：{'41467_2024_Article_52067': {'Part 1': ['step 6'], 'Part 3': ['step 1', 'step 2']}}\n\nII. 主要细胞亚家族和肿瘤细胞簇的识别：\n\n1. **细胞亚家族的识别：**\n   - 使用基因表达谱和经典标记识别数据集（GSE221493）中的主要细胞亚家族。\n   - 示例命令：`seurat_object <- AddModuleScore(seurat_object, features = list_of_marker_genes, name = 'subfamily')`。\n   - **目标：** 将细胞分类为肿瘤细胞、淋巴细胞、髓系细胞等亚家族。\n\n2. **聚类分组：**\n   - 使用标记基因表达将识别的簇分组为主要细胞亚家族。\n   - 示例命令：`seurat_object <- subset(seurat_object, idents = c('tumor', 'lymphoid', 'myeloid', 'adipocytes', 'mesothelial'))`。\n\n3. **肿瘤细胞识别：**\n   - 使用MDM2和CDK4的过表达以及12q染色体扩增作为标记（GSE179720）识别肿瘤细胞簇。\n   - 示例命令：`FeaturePlot(seurat_object, features = c('MDM2', 'CDK4'))`。\n\n4. **验证：**\n   - 使用已知文献和其他数据集（如果可用）验证识别的亚家族和肿瘤簇。\n\n5. **替代方法：**\n   - 如果Seurat不可用，考虑使用Monocle或SC3等其他单细胞分析工具进行聚类和识别。\n\n参考来源：{'41467_2024_Article_52067': {'Part 1': ['step 7'], 'Part 3': ['step 1']}}\n\nIII. 肿瘤微环境组成的比较：\n\n1. **比例分析：**\n   - 使用单细胞RNA-seq数据（GSE221493）分析肿瘤微环境（TME）中每个细胞簇的相对比例。\n   - 示例命令：`table(Idents(seurat_object))`。\n\n2. **比较分析：**\n   - 比较WDLPS和DDLPS样本中肿瘤和间质细胞群体的比例。\n   - 示例命令：`prop.table(table(Idents(seurat_object), seurat_object$sample_type))`。\n   - **目标：** 理解不同脂肪肉瘤类型中TME的组成差异。\n\n3. **使用整体数据验证：**\n   - 使用来自GSE221492的整体RNA-seq数据进行验证，以推断TME组成与MCP counter。\n   - 示例命令：`MCPcounter::MCPcounter.estimate(expression_data)`。\n   - **重点：** 评估髓系和淋巴细胞的表现。\n\n4. **替代方法：**\n   - 如果MCP counter不可用，考虑使用其他解卷积工具如CIBERSORT。\n\n5. **故障排除：**\n   - 如果单细胞和整体数据之间出现差异，重新评估整合和聚类步骤以查找潜在错误。\n\n参考来源：{'41467_2024_Article_52067': {'Part 1': ['step 8'], 'Part 3': ['step 3']}}\n\nIV. 使用整体RNA-seq数据验证：\n\n1. **数据加载和准备：**\n   - 加载来自GSE221492的整体RNA-seq数据以验证单细胞发现。\n   - 示例命令：`bulk_data <- read.table('path_to_bulk_data', header = TRUE, sep = '\\t')`。\n\n2. **层次聚类：**\n   - 使用800个变异性最大的基因进行层次聚类，以确保与单细胞簇的一致性。\n   - 示例命令：`heatmap_data <- bulk_data[order(apply(bulk_data, 1, var), decreasing = TRUE)[1:800], ]`。\n\n3. **基因表达验证：**\n   - 确认WDLPS中与脂肪细胞分化和干性相关的基因过表达，以及DDLPS中的侵袭和血管生成。\n   - 示例命令：`heatmap.2(as.matrix(heatmap_data), trace = 'none', col = bluered(100), scale = 'row')`。\n\n4. **交叉验证：**\n   - 将结果与其他研究或数据集的发现进行比较以确保有效性。\n\n5. **替代工具：**\n   - 如果层次聚类不可行，考虑使用PCA或t-SNE进行降维和可视化。\n\n参考来源：{'41467_2024_Article_52067': {'Part 3': ['step 6']}}\n\nV. 单细胞水平的差异基因表达和通路分析：\n\nA. **整合方法：**\n   1. 使用Celligner工具对齐单细胞RNA-seq数据和整体RNA-seq数据，以解决批次效应并整合数据集。\n   2. 示例命令：`integrated_data <- Celligner::align(single_cell_data, bulk_data)`。\n\nB. **差异表达分析：**\n   1. 使用整合数据集识别WDLPS和DDLPS之间的差异表达基因（DEGs）。\n   2. 示例命令：`DEGs <- FindMarkers(integrated_data, ident.1 = 'WDLPS', ident.2 = 'DDLPS')`。\n\nC. **通路富集分析：**\n   1. 使用clusterProfiler包对DEGs进行通路富集分析，以识别显著的代谢通路。\n   2. 示例命令：`enriched_pathways <- enrichKEGG(gene = DEGs$gene, organism = 'hsa')`。\n\nD. **预期结果：**\n   1. 全面识别脂肪肉瘤分化中涉及的肿瘤异质性和代谢通路。\n   2. 使用整体RNA-seq数据验证单细胞发现，突出显示关键通路如TGF-β信号传导和脂质代谢。\n\nE. **替代方法：**\n   - 如果clusterProfiler不可用，考虑使用GSEA进行通路分析。\n\n参考来源：cancers-15-03360: Part 3"
}

6596 7221